if("undefined"==typeof jQuery.aljs)throw new Error("Please include the ALJS initializer file");!function(e){var s=function(s,t){this.$el=e(s),this.settings=t,this.obj={},this.bindTrigger(),this.bindChoices()};s.prototype={constructor:s,bindTrigger:function(){var s=this,t=this.$el;this.obj.$trigger=e(".slds-button",t),this.obj.$dropdown=e(".slds-dropdown",t),this.obj.$choices=e(".slds-dropdown__item a",t),this.obj.$filter=e("#slds-filter",t),this.obj.$trigger.unbind().click(function(t){return t.stopPropagation(),s.obj.id=e(this).attr("id"),s.$el.hasClass("slds-is-open")?(s.$el.removeClass("slds-is-open"),s.obj.$dropdown.unbind("keyup",s.processKeypress)):(e('[data-aljs="picklist"]').not(s.$el).picklist("close"),s.$el.addClass("slds-is-open"),s.obj.$filter.focus(),null===s.obj.valueId||"undefined"==typeof s.obj.valueId?s.focusedIndex=null:s.focusedIndex=s.obj.$dropdown.find("li").index(s.obj.$dropdown.find("#"+s.obj.valueId)),s.focusOnElement(),s.obj.$dropdown.on("keyup",s,s.processKeypress)),!1}),e("body").click(function(){s.$el.removeClass("slds-is-open"),s.obj.$dropdown.unbind("keyup",s.processKeypress)}).keyup(function(s){27===s.keyCode&&e('[data-aljs="picklist"]').picklist("close")}),this.obj.$filter.on("click",function(){return!1}),this.obj.$filter.on("keyup",s,s.handleFilter)},handleFilter:function(e){var s,t=e.data,o=new RegExp(this.value.trim(),"i");[].forEach.call(t.obj.$choices,function(e){s=e.getAttribute("data-label-value").toLowerCase().match(o),e.style.display=s?null:"none"})},processKeypress:function(e){var s=e.data,t=s.obj.$choices.length;switch(e.keyCode){case 40:s.focusedIndex=s.focusedIndex===t-1?0:s.focusedIndex+1,s.focusOnElement();break;case 38:s.focusedIndex=0===s.focusedIndex?t-1:s.focusedIndex-1,s.focusOnElement();break;case 27:s.$el.picklist("close")}return!1},focusOnElement:function(){null!==this.focusedIndex&&this.obj.$choices.eq(this.focusedIndex).focus()},bindChoices:function(){var s=this;this.obj.$valueContainer=e("> span",this.obj.$trigger),this.obj.$choices.unbind().click(function(t){t.stopPropagation();var o=e(this).closest("li").attr("id");s.setValueAndUpdateDom(o),s.settings.onChange(s.obj)})},setValueAndUpdateDom:function(e){var s=this.$el.find("#"+e);this.obj.value=s.find("a").text(),this.obj.valueId=e,this.$el.removeClass("slds-is-open"),this.obj.$dropdown.unbind("keyup",this.processKeypress),this.obj.$trigger.trigger("change.aljs.picklist").focus(),this.obj.$valueContainer.text(this.obj.value),this.obj.$choices.parent().removeClass("slds-is-selected"),s.addClass("slds-is-selected")},setValue:function(e,s){this.setValueAndUpdateDom(e),s&&this.settings.onChange(this.obj)},getValueId:function(){return this.obj.valueId},getValue:function(){return this.obj},close:function(){this.$el.removeClass("slds-is-open"),this.obj.$dropdown.unbind("keyup",this.processKeypress)}},e.fn.picklist=function(t){var o,i=arguments,n=e.extend({assetsLocation:e.aljs.assetsLocation,onChange:function(e){}},"object"==typeof t?t:{});if(this.each(function(){var l=e(this),d=l.data("aljs-picklist");if(!d){var a=new s(this,n);l.data("aljs-picklist",d=a)}"string"==typeof t&&(o=d[t](i[1],i[2]))}),void 0===o||o instanceof s)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+option+" function)");return o}}(jQuery);